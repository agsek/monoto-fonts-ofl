var mnt=mnt||{};mnt.init=function(){this.methods.init()},mnt.consts={outputTagForStyles:"body",boldElements:[".hljs-keyword",".hljs-attribute",".hljs-selector-tag",".hljs-meta-keyword",".hljs-doctag",".hljs-name",".hljs-title",".hljs-section","strong","b"],otFeaturesDefault:["calt","ccmp","clig","curs","kern","liga","locl","mark","mkmk","rclt","rlig"],otFeaturesShowable:["afrc","c2pc","c2sc","calt","case","ccmp","clig","cpsp","cswh","curs","dlig","dnom","expt","falt","frac","fwid","halt","hist","hlig","hngl","hojo","hwid","ital","jalt","jp04","jp78","jp83","jp90","kern","liga","lnum","locl","mark","mgrk","mkmk","nalt","nlck","numr","onum","ordn","ornm","palt","pcap","pkna","pnum","pwid","qwid","rand","rclt","rlig","ruby","rvrn","salt","sinf","smcp","smpl","subs","sups","swsh","titl","tnam","tnum","trad","twid","unic","vhal","vpal","zero","ss01","ss02","ss03","ss04","ss05","ss06","ss07","ss08","ss09","ss10","ss11","ss12","ss13","ss14","ss15","ss16","ss17","ss18","ss19","ss20"],documentParts:["header","body"],cssVars:{ffs:"--font-feature-settings",fvs:"--font-variation-settings",fvsb:"--font-variation-settings-bold",fontFamily:"--font-family"}},mnt.fonts={},mnt.elements={jsCustomStylesheet:document.getElementById("jsCustomStylesheet").sheet},mnt.helpers={isPropertySupported:function(t){return t in document.body.style},getFontVariationBold:function(t,e){return mnt.fonts[e].bold?t.replace(/^(.*?'wght' )([\d.]*)(.*)$/,"$1"+mnt.fonts[e].bold+"$3"):null},setCssRule:function(t,e,n){return t+" { "+e+": "+n+"; }"},buildFontCssSettings:function(t,e,n){var s,i,a,n=n||{},o=mnt.fonts,l=[];if("feature"===e){var r=o[t].feature;for(s in r)n.hasOwnProperty(s)?l.push('"'+s+'" '+n[s]):r.hasOwnProperty(s)&&l.push('"'+s+'" '+r[s]);return l}if("variation"===e){var d=o[t].variation;for(i in d)n.hasOwnProperty(i)?a=n[i]:d.hasOwnProperty(i)&&(a=d[i].value||d[i].default),l.push('"'+i+'" '+a),"wght"===i&&(o[t].bold=mnt.helpers.setWghtAxisBoldValue(a,d[i].max));return l}},setWghtAxisBoldValue:function(t,e){return parseInt(t)+.6*(e-t)}},mnt.methods={init:function(){var t=this,e=["./fonts/Monoto-VF.woff","./fonts/VotoSerifGX.woff"];t.incompatibilityInform();for(var n=0;n<e.length;n++)t.getFontObject(e[n]).then(function(t){mnt.methods.updateFontsObject(t)}).catch(function(t){console.error("Augh, there was an error!",t)})},incompatibilityInform:function(){mnt.helpers.isPropertySupported("fontVariationSettings")||(alert("Whoa, hold your horses Dude! Your browser doesn't support core fuctionality: font-variation-settings! \nSwitch to Webkit Nightly browser to check out this cool cutting-edge feature! \n** At least you can still play with settings sliders ;) **"),console.log("Whoa, hold your horses Dude! Your browser doesn't support core fuctionality: font-variation-settings! \nSwitch to Webkit Nightly browser to check out this cool cutting-edge feature! \n** At least you can still play with settings sliders ;) **"))},updateOutputTag:function(t){var e,n=t.parentNode.children,s=t.offsetWidth-10,i=(t.value-t.getAttribute("min"))/(t.getAttribute("max")-t.getAttribute("min")),a=1.3;if(i<0)i=0;else if(i>1)i=s;else{var o=i;i=s*i+a,a-=o}for(var l=0;l<n.length;l++)"output"===n[l].tagName.toLowerCase()&&(mnt.fonts[t.dataset.fontName].variation[t.name].value=t.value,e=n[l],e.value=t.value,e.style.left=i+"px",e.style.marginLeft=a+"%")},updateFontFeatureSettings:function(t){mnt.fonts[t.dataset.fontName].feature[t.name]=t.checked?1:0},buildInputs:function(t,e,n,s){var i,a,o,l,r=n+"-settings",d=document.getElementById(r),u=document.createDocumentFragment();if("object"==typeof e){if(d||(d=document.createElement("ul"),d.id=r,d.classList.add("font-settings"),s&&d.classList.add("selected"),document.getElementById("settingsSection").appendChild(d)),"feature"===t){var m=document.createElement("fieldset");m.classList.add("checkboxes");for(o in e)e.hasOwnProperty(o)&&(i=document.createElement("input"),a=document.createElement("label"),i.type="checkbox",i.checked=e[o],i.name=o,i.setAttribute("data-font-name",n),a.innerText=o,u.appendChild(a).appendChild(i),mnt.methods.addFeatureCheckboxListener(i));return void d.appendChild(m).appendChild(u)}if("variation"===t)for(l in e)if(e.hasOwnProperty(l)){var c=document.createElement("li"),h=document.createElement("output");i=document.createElement("input"),a=document.createElement("label"),c.classList.add("input-set","range"),h.value=e[l].default,i.id=n+"-"+l,i.setAttribute("data-font-name",n),i.name=l,i.type="range",i.min=e[l].min,i.max=e[l].max,i.value=e[l].default,a.htmlFor=n+l,a.innerText=l,u.appendChild(h),u.appendChild(i),u.appendChild(a),d.appendChild(c).appendChild(u),mnt.methods.addAxisSliderListener(i),mnt.methods.updateOutputTag(i)}}},addAxisSliderListener:function(t){t.addEventListener("input",function(){mnt.methods.updateOutputTag(t),mnt.methods.setFontSettingsStyles(t.dataset.fontName)},!1)},addFeatureCheckboxListener:function(t){t.addEventListener("change",function(){mnt.methods.updateFontFeatureSettings(t),mnt.methods.setFontSettingsStyles(t.dataset.fontName)},!1)},addFontNameRadioListener:function(t){t.addEventListener("change",function(){var t=document.getElementById(this.id+"-settings");document.querySelector(".font-settings.selected").classList.remove("selected"),t.classList.add("selected");for(var e=0;e<t.childNodes.length;e++)for(var n=t.childNodes[e],s=0;s<n.childNodes.length;s++){var i=n.childNodes[s];"INPUT"===i.tagName&&(mnt.methods.updateOutputTag(i),mnt.methods.setFontSettingsStyles(i.dataset.fontName))}},!1)},insertCssRule:function(t){var e=t.stylesheet||mnt.elements.jsCustomStylesheet,n=t.selector||":root",s=t.value||"",i=t.property,a=!1;if(!e.cssRules.length)return void e.insertRule(mnt.helpers.setCssRule(n,i,s),e.cssRules.length);for(var o=0;o<e.cssRules.length;o++)e.cssRules[o].selectorText===n&&e.cssRules[o].style[0]===i&&(e.cssRules[o].style.cssText=i+": "+s,a=!0);a||e.insertRule(mnt.helpers.setCssRule(n,i,s),e.cssRules.length)},setFontSettingsStyles:function(t){var e=mnt.helpers.buildFontCssSettings(t,"feature").join(", "),n=mnt.helpers.buildFontCssSettings(t,"variation").join(", "),s=mnt.helpers.getFontVariationBold(n,t);mnt.methods.insertCssRule({property:mnt.consts.cssVars.ffs,value:e}),mnt.methods.insertCssRule({property:mnt.consts.cssVars.fvs,value:n}),s&&mnt.methods.insertCssRule({property:mnt.consts.cssVars.fvsb,value:s}),mnt.methods.insertCssRule({property:mnt.consts.cssVars.fontFamily,value:t})},getFontObject:function(t){return new Promise(function(e,n){var s=new XMLHttpRequest;s.open("GET",t),s.responseType="arraybuffer",s.onload=function(){if(4===this.readyState&&200===this.status){var t,i=this.response,a=new Buffer(i),o=document.createElement("link");t=fontkit.create(a),o.rel="stylesheet",o.type="application/font-woff",o.href=this.responseURL,document.getElementsByTagName("head")[0].appendChild(o),e(t)}else n(Error(s.statusText))},s.onerror=function(t){n(Error("Network Error"))},s.send()})},updateFontsObject:function(t){var e,n=t.availableFeatures,s={},i=t["OS/2"];if(e=i?(i.typoAscender-i.typoDescender+i.typoLineGap)/t.head.unitsPerEm:(t.hhea.ascent-t.hhea.descent+t.hhea.lineGap)/t.head.unitsPerEm,n)for(var a=0;a<n.length;a++){var o=n[a],l=mnt.consts.otFeaturesShowable.indexOf(o)>-1,r=mnt.consts.otFeaturesDefault.indexOf(o)>-1;l&&(s[o]=r?1:0)}mnt.fonts[t.postscriptName]={"line-height":e||1.2,variation:t.variationAxes,feature:s},mnt.methods.buildSettingsSection(t.postscriptName)},buildSettingsSection:function(t){var e,n=document.getElementById("fontName"),s=document.createElement("input"),i=document.createElement("label"),a=document.createDocumentFragment(),o=mnt.fonts[t],l=!1;n||(n=document.createElement("fieldset"),n.id="fontName",document.getElementById("settingsSection").appendChild(n),l=!0),i.innerHTML=t,i.htmlFor=t,s.type="radio",s.id=t,s.name="font-name",s.value=t,s.innerHTML=t,s.checked=l,a.appendChild(s),a.appendChild(i),n.appendChild(a);for(e in o)o.hasOwnProperty(e)&&mnt.methods.buildInputs(e,o[e],t,l);mnt.methods.addFontNameRadioListener(s),l&&mnt.methods.setFontSettingsStyles(t)}},mnt.adjustElementWidth={getTitleInputInnerWidth:function(){mnt.adjustElementWidth.buildOptions(),mnt.adjustElementWidth.options.editableElement.removeEventListener("input",mnt.adjustElementWidth.listener),mnt.adjustElementWidth.options.editableElement.addEventListener("input",mnt.adjustElementWidth.listener)},options:{},buildOptions:function(){var t=mnt.adjustElementWidth.options;t.editableElement=document.getElementsByTagName("h1")[0],t.ghostSpan=document.createElement("span"),t.editableElementComputedStyles=window.getComputedStyle(t.editableElement,null),t.editableElementWidth=t.editableElement.clientWidth,t.ghostSpan.innerText=t.editableElement.innerText,document.getElementsByTagName("footer")[0].appendChild(t.ghostSpan)},listener:function(){var t=mnt.adjustElementWidth.options;if(t.axisName="wdth",mnt.adjustElementWidth.setStyles(t),t.fontName&&mnt.fonts.hasOwnProperty(t.fontName)&&mnt.fonts[t.fontName].variation.hasOwnProperty(t.axisName)){if(t.axis=mnt.fonts[t.fontName].variation[t.axisName],t.currentAxisValue=mnt.adjustElementWidth.getCurrentAxisValue(t.axisName),console.log(t.ghostSpan.clientWidth),console.log(t.editableElementWidth),t.ghostSpan.clientWidth>=t.editableElementWidth)return void mnt.adjustElementWidth.binarySearch(parseInt(t.axis.min),t.currentAxisValue,t,0);t.ghostSpan.clientWidth<t.editableElementWidth&&mnt.adjustElementWidth.binarySearch(t.currentAxisValue,parseInt(t.axis.max),t,0)}},getCurrentAxisValue:function(t){mnt.adjustElementWidth.options.ghostSpan.style.fontVariationSettings.split(", ").forEach(function(e){for(var n=e.split(" "),s=0;s<n.length;s++)if(n[s]==="'"+t+"'")return parseInt(n[s+1])})},setStyles:function(t){var e;if(!t.editableElementComputedStyles)return console.error("Couldn't compute styles of: "+t.editableElement),null;for(e in t.editableElementComputedStyles)t.editableElementComputedStyles.hasOwnProperty(e)&&mnt.adjustElementWidth.isStylePropertyValid(t.editableElementComputedStyles[e])&&(t.ghostSpan.style[e]=t.editableElementComputedStyles[e]);t.ghostSpan.innerText=t.editableElement.innerText,t.ghostSpan.style.position="absolute",t.ghostSpan.style.width="auto",t.fontName=t.ghostSpan.style.fontFamily.split(", ")[0]},binarySearch:function(t,e,n,s){var i;if(!(s>10||(s++,n.currentAxisValue=Math.floor((e-t)/2+t),n.fvsValue=mnt.helpers.buildFontCssSettings(n.fontName,"variation").join(", "),n.editableElement.style.fontVariationSettings=n.fvsValue,n.ghostSpan.style.fontVariationSettings=n.fvsValue,(i=n.editableElementWidth-n.ghostSpan.clientWidth)<=.01*n.editableElementWidth&&i>0||t===e)))return n.ghostSpan.clientWidth>n.editableElementWidth?(e=parseInt(n.currentAxisValue),void mnt.adjustElementWidth.binarySearch(t,e,n,s)):void(n.ghostSpan.clientWidth<n.editableElementWidth&&(t=parseInt(n.currentAxisValue),mnt.adjustElementWidth.binarySearch(t,e,n,s)))},isStylePropertyValid:function(t){return void 0!==t&&"object"!=typeof t&&"function"!=typeof t&&t.length>0&&t!==parseInt(t)}},document.addEventListener("DOMContentLoaded",function(){mnt.init(),mnt.adjustElementWidth.getTitleInputInnerWidth()});